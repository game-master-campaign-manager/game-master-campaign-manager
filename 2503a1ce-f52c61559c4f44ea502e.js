/*! For license information please see 2503a1ce-f52c61559c4f44ea502e.js.LICENSE.txt */
"use strict";(self.webpackChunktheme_test=self.webpackChunktheme_test||[]).push([[358],{15822:function(t,n,e){e.d(n,{f1:function(){return Wn}});var r=e(70885),i=e(4942),o=e(64433),u=e(42982),a=e(88301),s=e(43144),c=e(15671),l=e(97326),f=e(60136),h=e(6215),v=e(61120),y=e(72407),p=(e(84944),e(33792),e(89103));function m(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=(0,v.Z)(t);if(n){var i=(0,v.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,h.Z)(this,e)}}var d=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r;return(0,c.Z)(this,e),r=n.call(this,'Operator "'.concat(t,'" is invalid')),TypeError.captureStackTrace&&TypeError.captureStackTrace((0,l.Z)(r),e),r.name="CompareOperatorError",r.operator=t,r}return(0,s.Z)(e)}((0,y.Z)(TypeError)),g=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r;return(0,c.Z)(this,e),r=n.call(this,"Invalid data format: ".concat(t)),Error.captureStackTrace&&Error.captureStackTrace((0,l.Z)(r),e),r.name="ImportError",r.data=t,r}return(0,s.Z)(e)}((0,y.Z)(Error)),w=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,c.Z)(this,e),r=n.call(this,'Die "'.concat(t,'" must have more than 1 possible value to ').concat(i||"do this action")),Error.captureStackTrace&&Error.captureStackTrace((0,l.Z)(r),e),r.name="DieActionValueError",r.action=i,r.die=t,r}return(0,s.Z)(e)}((0,y.Z)(Error)),k=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r;return(0,c.Z)(this,e),r=n.call(this,'Notation "'.concat(t,'" is invalid')),Error.captureStackTrace&&Error.captureStackTrace((0,l.Z)(r),e),r.name="NotationError",r.notation=t,r}return(0,s.Z)(e)}((0,y.Z)(Error)),b=function(t){(0,f.Z)(e,t);var n=m(e);function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,c.Z)(this,e),t=n.call(this,"Missing argument".concat(r?' "'.concat(r,'"'):"")),Error.captureStackTrace&&Error.captureStackTrace((0,l.Z)(t),e),t.argumentName=r,t}return(0,s.Z)(e)}((0,y.Z)(Error)),x=function(t){return(0,p.ku)(t)},Z=function(t){return("number"==typeof t||"string"==typeof t)&&(!Number.isNaN(t)&&Number.isFinite(Number(t)))},S=function(t){if(!Z(t))return!1;var n=Number(t);return n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER},A=9007199254740992,E=9007199254740991,T=-1>>>0,C=4294967296,O=2147483648,N=2147483647,R=1<<21,F=2097151;function M(t){return 0|t.next()}function P(t,n){return 0===n?t:function(e){return t(e)+n}}function I(t){var n=0|t.next(),e=t.next()>>>0;return(n&F)*C+e+(n&R?-9007199254740992:0)}function J(t){for(;;){var n=0|t.next();if(!(4194304&n)){var e=t.next()>>>0;return(n&F)*C+e+(n&R?-9007199254740992:0)}if(4194304==(8388607&n)&&0==(0|t.next()))return A}}function j(t){return t.next()>>>0}function V(t){var n=t.next()&F,e=t.next()>>>0;return n*C+e}function q(t){for(;;){var n=0|t.next();if(!(n&R)){var e=t.next()>>>0;return(n&F)*C+e}if(0==(n&F)&&0==(0|t.next()))return A}}function B(t){return 0==(t+1&t)}function _(t){return B(t)?(n=t,function(t){return t.next()&n}):function(t){var n=t+1,e=n*Math.floor(C/n);return function(t){var r=0;do{r=t.next()>>>0}while(r>=e);return r%n}}(t);var n}function D(t){var n,e=t+1;if(0==(0|e)){var r=(e/C|0)-1;if(B(r))return n=r,function(t){var e=t.next()&n,r=t.next()>>>0;return e*C+r}}return function(t){var n=t*Math.floor(A/t);return function(e){var r=0;do{var i=e.next()&F,o=e.next()>>>0;r=i*C+o}while(r>=n);return r%t}}(e)}function G(t,n){return function(e){var r=0;do{var i=0|e.next(),o=e.next()>>>0;r=(i&F)*C+o+(i&R?-9007199254740992:0)}while(r<t||r>n);return r}}function z(t,n){if(t=Math.floor(t),n=Math.floor(n),t<-9007199254740992||!isFinite(t))throw new RangeError("Expected min to be at least ".concat(-9007199254740992));if(n>A||!isFinite(n))throw new RangeError("Expected max to be at most ".concat(A));var e=n-t;return e<=0||!isFinite(e)?function(){return t}:e===T?0===t?j:P(M,t+O):e<T?P(_(e),t):e===E?P(V,t):e<E?P(D(e),t):n-1-t===E?P(q,t):-9007199254740992===t&&n===A?J:-9007199254740992===t&&n===E?I:-9007199254740991===t&&n===A?P(I,1):n===A?P(G(t-1,n-1),1):G(t,n)}function W(t){return 1==(1&t.next())}function U(t,n){return function(e){return t(e)<n}}function X(t,n){return null==n?null==t?W:function(t){if(t<=0)return function(){return!1};if(t>=1)return function(){return!0};var n=t*C;return n%1==0?U(M,n-O|0):U(V,Math.round(t*A))}(t):t<=0?function(){return!1}:t>=n?function(){return!0}:U(z(0,n-1),t)}function H(t){return z(1,t)}var K="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-";function L(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,n=t.length;if(!n)throw new Error("Expected pool not to be an empty string");var e=z(0,n-1);return function(n,r){for(var i="",o=0;o<r;++o){var u=e(n);i+=t.charAt(u)}return i}}var Q="0123456789abcdef",Y=L(Q),$=L(Q.toUpperCase());function tt(t,n){return t<0?Math.max(t+n,0):Math.min(t,n)}function nt(t){var n=+t;return n<0?Math.ceil(n):Math.floor(n)}function et(t,n){return 1===n?t:0===n?function(){return 0}:function(e){return t(e)*n}}function rt(t){return V(t)/A}function it(t){return q(t)/A}function ot(t,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!isFinite(t))throw new RangeError("Expected min to be a finite number");if(!isFinite(n))throw new RangeError("Expected max to be a finite number");return P(et(e?it:rt,n-t),t)}var ut=Array.prototype.slice;function at(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=n.length;if(r)for(var i=r-1>>>0;i>e;--i){var o=z(0,i),u=o(t);if(i!==u){var a=n[i];n[i]=n[u],n[u]=a}}return n}var st=function(){try{if("xxx"==="x".repeat(3))return function(t,n){return t.repeat(n)}}catch(t){}return function(t,n){for(var e="";n>0;)1&n&&(e+=t),n>>=1,t+=t;return e}}();function ct(t,n){return st("0",n-t.length)+t}var lt={next:function(){return Math.random()*C|0}},ft=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt;(0,c.Z)(this,t),this.engine=n}return(0,s.Z)(t,[{key:"int32",value:function(){return M(this.engine)}},{key:"uint32",value:function(){return j(this.engine)}},{key:"uint53",value:function(){return V(this.engine)}},{key:"uint53Full",value:function(){return q(this.engine)}},{key:"int53",value:function(){return I(this.engine)}},{key:"int53Full",value:function(){return J(this.engine)}},{key:"integer",value:function(t,n){return z(t,n)(this.engine)}},{key:"realZeroToOneInclusive",value:function(){return it(this.engine)}},{key:"realZeroToOneExclusive",value:function(){return rt(this.engine)}},{key:"real",value:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return ot(t,n,e)(this.engine)}},{key:"bool",value:function(t,n){return X(t,n)(this.engine)}},{key:"pick",value:function(t,n,e){return function(t,n,e,r){var i=n.length;if(0===i)throw new RangeError("Cannot pick from an empty array");var o=null==e?0:tt(nt(e),i),u=void 0===r?i:tt(nt(r),i);if(o>=u)throw new RangeError("Cannot pick between bounds ".concat(o," and ").concat(u));return n[z(o,u-1)(t)]}(this.engine,t,n,e)}},{key:"shuffle",value:function(t){return at(this.engine,t)}},{key:"sample",value:function(t,n){return function(t,n,e){if(e<0||e>n.length||!isFinite(e))throw new RangeError("Expected sampleSize to be within 0 and the length of the population");if(0===e)return[];var r=ut.call(n),i=r.length;if(i===e)return at(t,r,0);var o=i-e;return at(t,r,o-1).slice(o)}(this.engine,t,n)}},{key:"die",value:function(t){return H(t)(this.engine)}},{key:"dice",value:function(t,n){return function(t,n){var e=H(t);return function(t){for(var r=[],i=0;i<n;++i)r.push(e(t));return r}}(t,n)(this.engine)}},{key:"uuid4",value:function(){return t=this.engine,n=t.next()>>>0,e=0|t.next(),r=0|t.next(),i=t.next()>>>0,ct(n.toString(16),8)+"-"+ct((65535&e).toString(16),4)+"-"+ct((e>>4&4095|16384).toString(16),4)+"-"+ct((16383&r|32768).toString(16),4)+"-"+ct((r>>4&65535).toString(16),4)+ct(i.toString(16),8);var t,n,e,r,i}},{key:"string",value:function(t,n){return L(n)(this.engine,t)}},{key:"hex",value:function(t,n){return function(t){return t?$:Y}(n)(this.engine,t)}},{key:"date",value:function(t,n){return function(t,n){var e=z(+t,+n);return function(t){return new Date(e(t))}}(t,n)(this.engine)}}]),t}(),ht=function(){try{var t=new ArrayBuffer(4),n=new Int32Array(t);if(n[0]=O,-2147483648===n[0])return Int32Array}catch(e){}return Array}(),vt=null,yt=128,pt={next:function(){return yt>=128&&(null===vt&&(vt=new ht(128)),crypto.getRandomValues(vt),yt=0),0|vt[yt++]}};var mt=function(){try{if(-5===Math.imul(T,5))return Math.imul}catch(n){}var t=65535;return function(n,e){var r=n&t,i=e&t;return r*i+((n>>>16&t)*i+r*(e>>>16&t)<<16>>>0)|0}}(),dt=624,gt=623,wt=2567483615,kt=function(){function t(){(0,c.Z)(this,t),this.data=new ht(dt),this.index=0,this.uses=0}return(0,s.Z)(t,[{key:"next",value:function(){(0|this.index)>=dt&&(bt(this.data),this.index=0);var t=this.data[this.index];return this.index=this.index+1|0,this.uses+=1,0|function(t){return t^=t>>>11,t^=t<<7&2636928640,(t^=t<<15&4022730752)^t>>>18}(t)}},{key:"getUseCount",value:function(){return this.uses}},{key:"discard",value:function(t){if(t<=0)return this;for(this.uses+=t,(0|this.index)>=dt&&(bt(this.data),this.index=0);t+this.index>dt;)t-=dt-this.index,bt(this.data),this.index=0;return this.index=this.index+t|0,this}},{key:"seed",value:function(t){var n=0;this.data[0]=n=0|t;for(var e=1;e<dt;e=e+1|0)this.data[e]=n=mt(n^n>>>30,1812433253)+e|0;return this.index=dt,this.uses=0,this}},{key:"seedWithArray",value:function(t){return this.seed(19650218),function(t,n){for(var e=1,r=0,i=n.length,o=0|Math.max(i,dt),u=0|t[0];(0|o)>0;--o)t[e]=u=(t[e]^mt(u^u>>>30,1664525))+(0|n[r])+(0|r)|0,++r,(0|(e=e+1|0))>gt&&(t[0]=t[623],e=1),r>=i&&(r=0);for(o=gt;(0|o)>0;--o)t[e]=u=(t[e]^mt(u^u>>>30,1566083941))-e|0,(0|(e=e+1|0))>gt&&(t[0]=t[623],e=1);t[0]=O}(this.data,t),this}}],[{key:"seed",value:function(n){return(new t).seed(n)}},{key:"seedWithArray",value:function(n){return(new t).seedWithArray(n)}},{key:"autoSeed",value:function(){return t.seedWithArray(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,e=[];e.push(0|(new Date).getTime());for(var r=1;r<n;++r)e[r]=0|t.next();return e}())}}]),t}();function bt(t){for(var n=0,e=0;(0|n)<227;n=n+1|0)e=t[n]&O|t[n+1|0]&N,t[n]=t[n+397|0]^e>>>1^(1&e?wt:0);for(;(0|n)<gt;n=n+1|0)e=t[n]&O|t[n+1|0]&N,t[n]=t[n-227|0]^e>>>1^(1&e?wt:0);e=t[623]&O|t[0]&N,t[623]=t[396]^e>>>1^(1&e?wt:0)}var xt=null,Zt=128,St={next:function(){return Zt>=128&&(xt=new Int32Array(new Int8Array(e(38188).randomBytes(512)).buffer),Zt=0),0|xt[Zt++]}},At=Symbol("engine"),Et=Symbol("random"),Tt={browserCrypto:pt,nodeCrypto:St,MersenneTwister19937:kt,nativeMath:lt,min:{next:function(){return 0}},max:{range:[],next:function(){return this.range[1]-this.range[0]}}},Ct=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt;(0,c.Z)(this,t),this.engine=n||lt}return(0,s.Z)(t,[{key:"engine",get:function(){return this[At]},set:function(t){if(t&&"function"!=typeof t.next)throw new TypeError("engine must have function `next()`");this[At]=t||lt,this[Et]=new ft(this[At])}},{key:"integer",value:function(t,n){return this[At].range=[t,n],this[Et].integer(t,n)}},{key:"real",value:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this[At].range=[t,n],this[Et].real(t,n,e)}}]),t}(),Ot=new Ct,Nt=Symbol("operator"),Rt=Symbol("value"),Ft=function(){function t(n,e){if((0,c.Z)(this,t),!n)throw new b("operator");if(!e&&0!==e)throw new b("value");this.operator=n,this.value=e}return(0,s.Z)(t,[{key:"operator",get:function(){return this[Nt]},set:function(t){if(!this.constructor.isValidOperator(t))throw new d(t);this[Nt]=t}},{key:"value",get:function(){return this[Rt]},set:function(t){if(!Z(t))throw new TypeError("value must be a finite number");this[Rt]=Number(t)}},{key:"isMatch",value:function(t){return function(t,n,e){var r,i=Number(t),o=Number(n);if(Number.isNaN(i)||Number.isNaN(o))return!1;switch(e){case"=":case"==":r=i===o;break;case"<":r=i<o;break;case">":r=i>o;break;case"<=":r=i<=o;break;case">=":r=i>=o;break;case"!":case"!=":case"<>":r=i!==o;break;default:r=!1}return r}(t,this.value,this.operator)}},{key:"toJSON",value:function(){return{operator:this.operator,type:"compare-point",value:this.value}}},{key:"toString",value:function(){return"".concat(this.operator).concat(this.value)}}],[{key:"isValidOperator",value:function(t){return"string"==typeof t&&/^(?:[<>!]?=|[<>]|<>)$/.test(t)}}]),t}(),Mt=function(){function t(){(0,c.Z)(this,t),this.order=999}return(0,s.Z)(t,[{key:"name",get:function(){return"modifier"}},{key:"notation",get:function(){return""}},{key:"maxIterations",get:function(){return 1e3}},{key:"run",value:function(t,n){return t}},{key:"toJSON",value:function(){var t=this.notation;return{name:this.name,notation:t,type:"modifier"}}},{key:"toString",value:function(){return this.notation}}]),t}(),Pt=Symbol("compare-point"),It=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r;return(0,c.Z)(this,e),r=n.call(this),t&&(r.comparePoint=t),r}return(0,s.Z)(e,[{key:"comparePoint",get:function(){return this[Pt]},set:function(t){if(!(t instanceof Ft))throw new TypeError("comparePoint must be instance of ComparePoint");this[Pt]=t}},{key:"name",get:function(){return"comparison"}},{key:"notation",get:function(){return"".concat(this.comparePoint||"")}},{key:"isComparePoint",value:function(t){return!!this.comparePoint&&this.comparePoint.isMatch(t)}},{key:"toJSON",value:function(){var t=this.comparePoint;return Object.assign((0,a.Z)((0,v.Z)(e.prototype),"toJSON",this).call(this),{comparePoint:t})}}]),e}(Mt),Jt=Symbol("compound"),jt=Symbol("penetrate"),Vt=function(t){(0,f.Z)(e,t);var n=m(e);function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,c.Z)(this,e),(t=n.call(this,r))[Jt]=!!i,t[jt]=!!o,t.order=3,t}return(0,s.Z)(e,[{key:"compound",get:function(){return this[Jt]}},{key:"name",get:function(){return"explode"}},{key:"notation",get:function(){return"!".concat(this.compound?"!":"").concat(this.penetrate?"p":"").concat((0,a.Z)((0,v.Z)(e.prototype),"notation",this))}},{key:"penetrate",get:function(){return this[jt]}},{key:"run",value:function(t,n){var e=this;if(n.min===n.max)throw new w(n,"explode");var r=t;return r.rolls=t.rolls.map((function(t){for(var r,i=[t],o=t.value,u=0;u<e.maxIterations&&e.isComparePoint(o);u++){var a=i[i.length-1],s=n.rollOnce();o=s.value,a.modifiers.add("explode"),e.penetrate&&(a.modifiers.add("penetrate"),s.value-=1),i.push(s)}return e.compound&&i.length>1?(t.value=(r=i.map((function(t){return t.value})),Array.isArray(r)?r.reduce((function(t,n){return t+(Z(n)?parseFloat("".concat(n)):0)}),0):0),t.modifiers=["explode","compound"],e.penetrate&&t.modifiers.add("penetrate"),t):i})).flat(),r}},{key:"toJSON",value:function(){var t=this.compound,n=this.penetrate;return Object.assign((0,a.Z)((0,v.Z)(e.prototype),"toJSON",this).call(this),{compound:t,penetrate:n})}}]),e}(It),qt={compound:"!",explode:"!","critical-failure":"__","critical-success":"**",drop:"d",max:"v",min:"^",penetrate:"p","re-roll":"r","re-roll-once":"ro","target-failure":"_","target-success":"*"},Bt=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return[].concat(n).reduce((function(t,n){var e;return e=n instanceof Mt?n.name:n,t+(qt[e]||e)}),"")},_t=Symbol("calculation-value"),Dt=Symbol("modifiers"),Gt=Symbol("initial-value"),zt=Symbol("use-in-total"),Wt=Symbol("value"),Ut=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if((0,c.Z)(this,t),Z(n))this[Gt]=Number(n),this.modifiers=e||[],this.useInTotal=r;else{if(!n||"object"!=typeof n||Array.isArray(n))throw n===1/0?new RangeError("Result value must be a finite number"):new TypeError("Result value is invalid: ".concat(n));var i=Z(n.initialValue)?n.initialValue:n.value;if(!Z(i))throw new TypeError("Result value is invalid: ".concat(i));this[Gt]=Number(i),Z(n.value)&&Number(n.value)!==this[Gt]&&(this.value=n.value),Z(n.calculationValue)&&parseFloat("".concat(n.calculationValue))!==this.value&&(this.calculationValue=n.calculationValue),this.modifiers=n.modifiers||e||[],this.useInTotal="boolean"==typeof n.useInTotal?n.useInTotal:r||!1}}return(0,s.Z)(t,[{key:"calculationValue",get:function(){return Z(this[_t])?parseFloat(this[_t]):this.value},set:function(t){var n=Z(t);if(t===1/0)throw new RangeError("Result calculation value must be a finite number");if(t&&!n)throw new TypeError("Result calculation value is invalid: ".concat(t));this[_t]=n?parseFloat("".concat(t)):null}},{key:"initialValue",get:function(){return this[Gt]}},{key:"modifierFlags",get:function(){return Bt.apply(void 0,(0,u.Z)(this.modifiers))}},{key:"modifiers",get:function(){return this[Dt]},set:function(t){if((Array.isArray(t)||t instanceof Set)&&(0,u.Z)(t).every((function(t){return"string"==typeof t})))this[Dt]=new Set((0,u.Z)(t));else{if(t||0===t)throw new TypeError("modifiers must be a Set or array of modifier names: ".concat(t));this[Dt]=new Set}}},{key:"useInTotal",get:function(){return!!this[zt]},set:function(t){this[zt]=!!t}},{key:"value",get:function(){return Z(this[Wt])?this[Wt]:this[Gt]},set:function(t){if(t===1/0)throw new RangeError("Result value must be a finite number");if(!Z(t))throw new TypeError("Result value is invalid: ".concat(t));this[Wt]=Number(t)}},{key:"toJSON",value:function(){var t=this.calculationValue,n=this.initialValue,e=this.modifierFlags,r=this.modifiers,i=this.useInTotal,o=this.value;return{calculationValue:t,initialValue:n,modifierFlags:e,modifiers:(0,u.Z)(r),type:"result",useInTotal:i,value:o}}},{key:"toString",value:function(){return this.value+this.modifierFlags}}]),t}(),Xt=Symbol("rolls"),Ht=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,c.Z)(this,t),this.rolls=n}return(0,s.Z)(t,[{key:"length",get:function(){return this.rolls.length||0}},{key:"rolls",get:function(){return(0,u.Z)(this[Xt])},set:function(t){var n=this;if(!t||!Array.isArray(t))throw new TypeError("rolls must be an array: ".concat(t));this[Xt]=[],t.forEach((function(t){n.addRoll(t)}))}},{key:"value",get:function(){return this.rolls.reduce((function(t,n){return t+(n.useInTotal?n.calculationValue:0)}),0)}},{key:"addRoll",value:function(t){var n=t instanceof Ut?t:new Ut(t);this[Xt].push(n)}},{key:"toJSON",value:function(){return{rolls:this.rolls,type:"roll-results",value:this.value}}},{key:"toString",value:function(){return"[".concat(this.rolls.join(", "),"]")}}]),t}(),Kt=Symbol("once"),Lt=function(t){(0,f.Z)(e,t);var n=m(e);function e(){var t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,c.Z)(this,e),(t=n.call(this,i)).once=!!r,t.order=4,t}return(0,s.Z)(e,[{key:"name",get:function(){return"re-roll"}},{key:"notation",get:function(){return"r".concat(this.once?"o":"").concat((0,a.Z)((0,v.Z)(e.prototype),"notation",this))}},{key:"once",get:function(){return!!this[Kt]},set:function(t){this[Kt]=!!t}},{key:"run",value:function(t,n){var e=this;if(n.min===n.max)throw new w(n,"re-roll");return t.rolls.map((function(t){for(var r=0;r<e.maxIterations&&e.isComparePoint(t.value);r++){var i=n.rollOnce();if(t.value=i.value,t.modifiers.add("re-roll".concat(e.once?"-once":"")),e.once)break}return t})),t}},{key:"toJSON",value:function(){var t=this.once;return Object.assign((0,a.Z)((0,v.Z)(e.prototype),"toJSON",this).call(this),{once:t})}}]),e}(It),Qt=Symbol("modifiers"),Yt=Symbol("qty"),$t=Symbol("sides"),tn=Symbol("min-value"),nn=Symbol("max-value"),en=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if((0,c.Z)(this,t),!n&&0!==n)throw new b("sides");if(n===1/0)throw new RangeError("numerical sides must be finite number");if(Z(n)){if(n<1||!S(n))throw new RangeError("numerical sides must be a positive finite number")}else if("string"!=typeof n)throw new TypeError("non-numerical sides must be a string");if(!Z(e))throw new TypeError("qty must be a positive finite integer");if(e<1||e>999)throw new RangeError("qty must be between 1 and 999");if(!Z(i))throw new TypeError("min must a finite number");if(!S(i))throw new RangeError("min must a finite number");if(o&&!Z(o))throw new TypeError("max must a finite number");if(o&&!S(o))throw new RangeError("max must a finite number");this[Yt]=parseInt("".concat(e),10),this[$t]=n,r&&(this.modifiers=r),this[tn]=parseInt(i,10),this[nn]=o?parseInt("".concat(o),10):n}return(0,s.Z)(t,[{key:"average",get:function(){return(this.min+this.max)/2}},{key:"modifiers",get:function(){return this[Qt]?new Map((0,u.Z)(this[Qt]).sort((function(t,n){return t[1].order-n[1].order}))):null},set:function(t){var n,e=this;if(t instanceof Map)n=t;else if(Array.isArray(t))n=new Map(t.map((function(t){return[t.name,t]})));else{if("object"!=typeof t)throw new TypeError("modifiers should be a Map, array, or an Object containing Modifiers");n=new Map(Object.entries(t))}if(n.size&&(0,u.Z)(n.entries()).some((function(t){return!(t[1]instanceof Mt)})))throw new TypeError("modifiers must only contain Modifier instances");this[Qt]=n,this[Qt].forEach((function(t){t instanceof Vt&&!t.comparePoint?t.comparePoint=new Ft("=",e.max):t instanceof Lt&&!t.comparePoint&&(t.comparePoint=new Ft("=",e.min))}))}},{key:"max",get:function(){return this[nn]}},{key:"min",get:function(){return this[tn]}},{key:"name",get:function(){return"standard"}},{key:"notation",get:function(){var t="".concat(this.qty,"d").concat(this.sides);return this.modifiers&&this.modifiers.size&&(t+=(0,u.Z)(this.modifiers.values()).reduce((function(t,n){return t+n.notation}),"")),t}},{key:"qty",get:function(){return this[Yt]}},{key:"sides",get:function(){return this[$t]}},{key:"roll",value:function(){for(var t=this,n=new Ht,e=0;e<this.qty;e++)n.addRoll(this.rollOnce());return(this.modifiers||[]).forEach((function(e){e.run(n,t)})),n}},{key:"rollOnce",value:function(){return new Ut(Ot.integer(this.min,this.max))}},{key:"toJSON",value:function(){return{average:this.average,max:this.max,min:this.min,modifiers:this.modifiers,name:this.name,notation:this.notation,qty:this.qty,sides:this.sides,type:"die"}}},{key:"toString",value:function(){return this.notation}}]),t}(),rn=function(t){(0,f.Z)(e,t);var n=m(e);function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,c.Z)(this,e);var o=t;if(o||0===o){if(1!==o&&2!==o)throw new RangeError("nonBlanks must be 1 or 2")}else o=2;return n.call(this,o,r,i,-1,1)}return(0,s.Z)(e,[{key:"name",get:function(){return"fudge"}},{key:"nonBlanks",get:function(){return(0,a.Z)((0,v.Z)(e.prototype),"sides",this)}},{key:"sides",get:function(){return"F.".concat(this.nonBlanks)}},{key:"rollOnce",value:function(){var t=0;if(2===this.nonBlanks)t=Ot.integer(1,3)-2;else if(1===this.nonBlanks){var n=Ot.integer(1,6);1===n?t=-1:6===n&&(t=1)}return new Ut(t)}}]),e}(en),on=function(t){(0,f.Z)(e,t);var n=m(e);function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,c.Z)(this,e),(t=n.call(this,100,r,i)).sidesAsNumber=!!o,t}return(0,s.Z)(e,[{key:"name",get:function(){return"percentile"}},{key:"sides",get:function(){return this.sidesAsNumber?(0,a.Z)((0,v.Z)(e.prototype),"sides",this):"%"}}]),e}(en),un=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r;return(0,c.Z)(this,e),(r=n.call(this,t)).order=9,r}return(0,s.Z)(e,[{key:"name",get:function(){return"critical-failure"}},{key:"notation",get:function(){return"cf".concat((0,a.Z)((0,v.Z)(e.prototype),"notation",this))}},{key:"run",value:function(t,n){var e=this;return t.rolls.forEach((function(t){return e.isComparePoint(t.value)&&t.modifiers.add("critical-failure"),t})),t}}]),e}(It),an=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r;return(0,c.Z)(this,e),(r=n.call(this,t)).order=8,r}return(0,s.Z)(e,[{key:"name",get:function(){return"critical-success"}},{key:"notation",get:function(){return"cs".concat((0,a.Z)((0,v.Z)(e.prototype),"notation",this))}},{key:"run",value:function(t,n){var e=this;return t.rolls.forEach((function(t){return e.isComparePoint(t.value)&&t.modifiers.add("critical-success"),t})),t}}]),e}(It),sn=Symbol("calculation-value"),cn=Symbol("is-roll-group"),ln=Symbol("modifiers"),fn=Symbol("results"),hn=Symbol("use-in-total"),vn=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];(0,c.Z)(this,t),this.isRollGroup=r,this.modifiers=e,this.results=n,this.useInTotal=i}return(0,s.Z)(t,[{key:"calculationValue",get:function(){return Z(this[sn])?parseFloat(this[sn]):this.value},set:function(t){var n=Z(t);if(t===1/0)throw new RangeError("Results calculation value must be a finite number");if(t&&!n)throw new TypeError("Results calculation value is invalid: ".concat(t));this[sn]=n?parseFloat("".concat(t)):null}},{key:"isRollGroup",get:function(){return this[cn]},set:function(t){this[cn]=!!t}},{key:"length",get:function(){return this.results.length||0}},{key:"modifierFlags",get:function(){return Bt.apply(void 0,(0,u.Z)(this.modifiers))}},{key:"modifiers",get:function(){return this[ln]},set:function(t){if((Array.isArray(t)||t instanceof Set)&&(0,u.Z)(t).every((function(t){return"string"==typeof t})))this[ln]=new Set((0,u.Z)(t));else{if(t||0===t)throw new TypeError("modifiers must be a Set or array of modifier names: ".concat(t));this[ln]=new Set}}},{key:"results",get:function(){return(0,u.Z)(this[fn])},set:function(t){var n=this;if(!t||!Array.isArray(t))throw new TypeError("results must be an array: ".concat(t));this[fn]=[],t.forEach((function(t){n.addResult(t)}))}},{key:"useInTotal",get:function(){return!!this[hn]},set:function(t){this[hn]=!!t}},{key:"value",get:function(){if(!this.results.length)return 0;var n=this.results.reduce((function(n,e){var r=e;return e instanceof t?r=e.useInTotal?e.calculationValue:0:e instanceof Ht&&(r=e.value),n+r}),"string"==typeof this.results[0]?"":0);return"string"==typeof n?x(n):n}},{key:"addResult",value:function(n){var e;if(n instanceof t||n instanceof Ht)e=n;else{if("string"!=typeof n&&!Z(n))throw new TypeError("value must be one of ResultGroup, RollResults, string, or number");e=n}this[fn].push(e)}},{key:"toJSON",value:function(){var t=this.calculationValue,n=this.isRollGroup,e=this.modifierFlags,r=this.modifiers,i=this.results,o=this.useInTotal,a=this.value;return{calculationValue:t,isRollGroup:n,modifierFlags:e,modifiers:(0,u.Z)(r),results:i,type:"result-group",useInTotal:o,value:a}}},{key:"toString",value:function(){var t;return t=this.isRollGroup?"{".concat(this.results.join(", "),"}"):this.results.join(""),this.modifierFlags&&(t="(".concat(t,")").concat(this.modifierFlags)),t}}]),t}(),yn=Symbol("end"),pn=Symbol("qty"),mn=function(t){(0,f.Z)(e,t);var n=m(e);function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"h",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,c.Z)(this,e),(t=n.call(this)).end=r,t.qty=i,t.order=5,t}return(0,s.Z)(e,[{key:"end",get:function(){return this[yn]},set:function(t){if("h"!==t&&"l"!==t)throw new RangeError('End must be "h" or "l"');this[yn]=t}},{key:"name",get:function(){return"keep-".concat(this.end)}},{key:"notation",get:function(){return"k".concat(this.end).concat(this.qty)}},{key:"qty",get:function(){return this[pn]},set:function(t){if(t===1/0)throw new RangeError("qty must be a finite number");if(!Z(t)||t<1)throw new TypeError("qty must be a positive finite integer");this[pn]=Math.floor(t)}},{key:"rangeToDrop",value:function(t){return"h"===this.end?[0,t.length-this.qty]:[this.qty,t.length]}},{key:"run",value:function(t,n){var e,r,i;return t instanceof vn?i=1===(r=t.results).length&&r[0]instanceof vn?r[0].results.map((function(t,n){return t instanceof Ht?t.rolls.map((function(t,e){return{value:t.value,index:[n,e]}})):null})).flat().filter(Boolean):(0,u.Z)(r).map((function(t,n){return{value:t.value,index:n}})):(r=t.rolls,i=(0,u.Z)(r).map((function(t,n){return{value:t.value,index:n}}))),(i=(e=i.sort((function(t,n){return t.value-n.value})).map((function(t){return t.index}))).slice.apply(e,(0,u.Z)(this.rangeToDrop(i)))).forEach((function(t){var n;(n=Array.isArray(t)?r[0].results[t[0]].rolls[t[1]]:r[t]).modifiers.add("drop"),n.useInTotal=!1})),t}},{key:"toJSON",value:function(){var t=this.end,n=this.qty;return Object.assign((0,a.Z)((0,v.Z)(e.prototype),"toJSON",this).call(this),{end:t,qty:n})}}]),e}(Mt),dn=function(t){(0,f.Z)(e,t);var n=m(e);function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"l",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,c.Z)(this,e),(t=n.call(this,r,i)).order=6,t}return(0,s.Z)(e,[{key:"name",get:function(){return"drop-".concat(this.end)}},{key:"notation",get:function(){return"d".concat(this.end).concat(this.qty)}},{key:"rangeToDrop",value:function(t){return"h"===this.end?[t.length-this.qty,t.length]:[0,this.qty]}}]),e}(mn),gn=Symbol("max"),wn=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r;return(0,c.Z)(this,e),(r=n.call(this)).max=t,r.order=2,r}return(0,s.Z)(e,[{key:"max",get:function(){return this[gn]},set:function(t){if(!Z(t))throw new TypeError("max must be a number");this[gn]=parseFloat("".concat(t))}},{key:"name",get:function(){return"max"}},{key:"notation",get:function(){return"max".concat(this.max)}},{key:"run",value:function(t,n){var e=this,r=t;return r.rolls=t.rolls.map((function(t){var n=t;return t.value>e.max&&(n.value=e.max,n.modifiers.add("max")),n})),r}},{key:"toJSON",value:function(){var t=this.max;return Object.assign((0,a.Z)((0,v.Z)(e.prototype),"toJSON",this).call(this),{max:t})}}]),e}(Mt),kn=Symbol("min"),bn=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r;return(0,c.Z)(this,e),(r=n.call(this)).min=t,r.order=1,r}return(0,s.Z)(e,[{key:"min",get:function(){return this[kn]},set:function(t){if(!Z(t))throw new TypeError("min must be a number");this[kn]=parseFloat("".concat(t))}},{key:"name",get:function(){return"min"}},{key:"notation",get:function(){return"min".concat(this.min)}},{key:"run",value:function(t,n){var e=this,r=t;return r.rolls=t.rolls.map((function(t){var n=t;return t.value<e.min&&(n.value=e.min,n.modifiers.add("min")),n})),r}},{key:"toJSON",value:function(){var t=this.min;return Object.assign((0,a.Z)((0,v.Z)(e.prototype),"toJSON",this).call(this),{min:t})}}]),e}(Mt),xn=Symbol("direction"),Zn=function(t){(0,f.Z)(e,t);var n=m(e);function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";return(0,c.Z)(this,e),(t=n.call(this)).direction=r,t.order=10,t}return(0,s.Z)(e,[{key:"direction",get:function(){return this[xn]},set:function(t){if("a"!==t&&"d"!==t)throw new RangeError('Direction must be "a" (Ascending) or "d" (Descending)');this[xn]=t}},{key:"name",get:function(){return"sorting"}},{key:"notation",get:function(){return"s".concat(this.direction)}},{key:"run",value:function(t,n){var e,r=this;return t[e=t instanceof vn?"results":"rolls"]=t[e].sort((function(t,n){return"d"===r.direction?n.value-t.value:t.value-n.value})),t instanceof vn&&(t[e]=t[e].map((function(t){return t instanceof vn||t instanceof Ht?r.run(t,n):t}))),t}},{key:"toJSON",value:function(){var t=this.direction;return Object.assign((0,a.Z)((0,v.Z)(e.prototype),"toJSON",this).call(this),{direction:t})}}]),e}(Mt),Sn=Symbol("failure-cp"),An=function(t){(0,f.Z)(e,t);var n=m(e);function e(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,c.Z)(this,e),(r=n.call(this,t)).failureComparePoint=i,r.order=7,r}return(0,s.Z)(e,[{key:"failureComparePoint",get:function(){return this[Sn]},set:function(t){if(t&&!(t instanceof Ft))throw new TypeError("failure comparePoint must be instance of ComparePoint or null");this[Sn]=t||null}},{key:"name",get:function(){return"target"}},{key:"notation",get:function(){return"".concat((0,a.Z)((0,v.Z)(e.prototype),"notation",this)).concat(this.failureComparePoint?"f".concat(this.failureComparePoint):"")}},{key:"successComparePoint",get:function(){return this.comparePoint},set:function(t){(0,o.Z)((0,v.Z)(e.prototype),"comparePoint",t,this,!0)}},{key:"getStateValue",value:function(t){return this.isSuccess(t)?1:this.isFailure(t)?-1:0}},{key:"isFailure",value:function(t){return!!this.failureComparePoint&&this.failureComparePoint.isMatch(t)}},{key:"isNeutral",value:function(t){return!this.isSuccess(t)&&!this.isFailure(t)}},{key:"isSuccess",value:function(t){return this.isComparePoint(t)}},{key:"run",value:function(t,n){var e=this;return(t instanceof vn?t.results:t.rolls).forEach((function(t){e.isSuccess(t.value)?t.modifiers.add("target-success"):e.isFailure(t.value)&&t.modifiers.add("target-failure"),t.calculationValue=e.getStateValue(t.value)})),t}},{key:"toJSON",value:function(){var t=this.failureComparePoint,n=this.successComparePoint,r=(0,a.Z)((0,v.Z)(e.prototype),"toJSON",this).call(this);return delete r.comparePoint,Object.assign(r,{failureComparePoint:t,successComparePoint:n})}}]),e}(It),En=function(t){try{return!(!t||btoa(atob(t))!==t)}catch(n){return!1}},Tn=function(t){try{var n=!!t&&JSON.parse(t);return!(!n||"object"!=typeof n)}catch(e){return!1}},Cn=Symbol("modifiers"),On=Symbol("expressions"),Nn=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,c.Z)(this,t),this.expressions=n,this.modifiers=e}return(0,s.Z)(t,[{key:"expressions",get:function(){return(0,u.Z)(this[On]||[])},set:function(t){var n=this;if(!t)throw new b("expressions");if(!Array.isArray(t))throw new TypeError("expressions must be an array: ".concat(t));this[On]=[],t.forEach((function(e){if(!e||!Array.isArray(e))throw new TypeError("Expressions must be an array of arrays: ".concat(t));if(0===e.length)throw new TypeError("Sub expressions cannot be empty: ".concat(t));if(!e.every((function(t){return t instanceof en||"string"==typeof t||"number"==typeof t})))throw new TypeError("Sub expression items must be Dice, numbers, or strings");n[On].push(e)}))}},{key:"modifiers",get:function(){return this[Cn]?new Map((0,u.Z)(this[Cn]).sort((function(t,n){return t[1].order-n[1].order}))):null},set:function(t){var n;if(t instanceof Map)n=t;else if(Array.isArray(t))n=new Map(t.map((function(t){return[t.name,t]})));else{if("object"!=typeof t)throw new TypeError("modifiers should be a Map, array, or an Object containing Modifiers");n=new Map(Object.entries(t))}if(n.size&&(0,u.Z)(n.entries()).some((function(t){return!(t[1]instanceof Mt)})))throw new TypeError("modifiers must only contain Modifier instances");this[Cn]=n}},{key:"notation",get:function(){var t=this.expressions.map((function(t){return t.reduce((function(t,n){return t+n}),"")})).join(", ");return t="{".concat(t,"}"),this.modifiers&&this.modifiers.size&&(t+=(0,u.Z)(this.modifiers.values()).reduce((function(t,n){return t+n.notation}),"")),t}},{key:"roll",value:function(){var t=this,n=new vn(this.expressions.map((function(t){var n=t.map((function(t){return t instanceof en?t.roll():t}));return new vn(n)})));return n.isRollGroup=!0,(this.modifiers||[]).forEach((function(e){e.run(n,t)})),n}},{key:"toJSON",value:function(){var t=this.modifiers,n=this.notation;return{expressions:this.expressions,modifiers:t,notation:n,type:"group"}}},{key:"toString",value:function(){return this.notation}}]),t}();function Rn(t,n,e,r){var i=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(i,Rn.prototype),i.expected=n,i.found=e,i.location=r,i.name="SyntaxError",i}function Fn(t,n,e){return e=e||" ",t.length>n?t:(n-=t.length,t+(e+=e.repeat(n)).slice(0,n))}function Mn(t,n){var e,o,a,s,c={},l=(n=void 0!==n?n:{}).grammarSource,f={Main:pn},h=pn,v=",",y="d",p="d%",m="dF",d="!",g="max",w="min",k="cs",b="cf",Z="!=",S="<=",A=">=",E="<>",T="(",C=")",O="abs",N="ceil",R="cos",F="exp",M="floor",P="log",I="round",J="sign",j="sin",V="sqrt",q="tan",B="pow",_=/^[12]/,D=/^[lh]/,G=/^[.]/,z=/^[1-9]/,W=/^[0-9]/,U=/^[ \t\n\r]/,X=ln("{",!1),H=ln(",",!1),K=ln("}",!1),L=ln("d",!1),Q=ln("d%",!1),Y=ln("dF",!1),$=ln(".",!1),tt=fn(["1","2"],!1,!1),nt=ln("!",!1),et=ln("p",!1),rt=fn(["l","h"],!1,!1),it=ln("k",!1),ot=ln("max",!1),ut=ln("min",!1),at=ln("r",!1),st=ln("o",!1),ct=ln("cs",!1),lt=ln("cf",!1),ft=ln("s",!1),ht=ln("a",!1),vt=ln("f",!1),yt=ln("!=",!1),pt=ln("<=",!1),mt=ln(">=",!1),dt=ln("=",!1),gt=ln("<>",!1),wt=ln(">",!1),kt=ln("<",!1),bt=ln("(",!1),xt=ln(")",!1),Zt=ln("abs",!1),St=ln("ceil",!1),At=ln("cos",!1),Et=ln("exp",!1),Tt=ln("floor",!1),Ct=ln("log",!1),Ot=ln("round",!1),Nt=ln("sign",!1),Rt=ln("sin",!1),Mt=ln("sqrt",!1),Pt=ln("tan",!1),It=ln("pow",!1),Jt=ln("-",!1),jt=fn(["."],!1,!1),qt=fn([["1","9"]],!1,!1),Bt=fn([["0","9"]],!1,!1),_t=ln("**",!1),Dt=ln("*",!1),Gt=ln("^",!1),zt=ln("%",!1),Wt=ln("/",!1),Ut=ln("+",!1),Xt={type:"other",description:"whitespace"},Ht=fn([" ","\t","\n","\r"],!1,!1),Kt=function(){return parseInt(cn(),10)},Qt=0,Yt=0,$t=[{line:1,column:1}],tn=0,nn=[],sn=0;if("startRule"in n){if(!(n.startRule in f))throw new Error("Can't start parsing from rule \""+n.startRule+'".');h=f[n.startRule]}function cn(){return t.substring(Yt,Qt)}function ln(t,n){return{type:"literal",text:t,ignoreCase:n}}function fn(t,n,e){return{type:"class",parts:t,inverted:n,ignoreCase:e}}function hn(n){var e,r=$t[n];if(r)return r;for(e=n-1;!$t[e];)e--;for(r={line:(r=$t[e]).line,column:r.column};e<n;)10===t.charCodeAt(e)?(r.line++,r.column=1):r.column++,e++;return $t[n]=r,r}function vn(t,n){var e=hn(t),r=hn(n);return{source:l,start:{offset:t,line:e.line,column:e.column},end:{offset:n,line:r.line,column:r.column}}}function yn(t){Qt<tn||(Qt>tn&&(tn=Qt,nn=[]),nn.push(t))}function pn(){return Tn()}function gn(){var n,e,r,o,a,s,l,f,h,v,y;if(n=Qt,123===t.charCodeAt(Qt)?(e="{",Qt++):(e=c,0===sn&&yn(X)),e!==c)if(In(),(r=Tn())!==c){for(o=[],a=Qt,s=In(),44===t.charCodeAt(Qt)?(l=",",Qt++):(l=c,0===sn&&yn(H)),l!==c?(f=In(),(h=Tn())!==c?a=s=[s,l,f,h]:(Qt=a,a=c)):(Qt=a,a=c);a!==c;)o.push(a),a=Qt,s=In(),44===t.charCodeAt(Qt)?(l=",",Qt++):(l=c,0===sn&&yn(H)),l!==c?(f=In(),(h=Tn())!==c?a=s=[s,l,f,h]:(Qt=a,a=c)):(Qt=a,a=c);if(a=In(),125===t.charCodeAt(Qt)?(s="}",Qt++):(s=c,0===sn&&yn(K)),s!==c){for(l=[],f=xn();f!==c;)l.push(f),f=xn();Yt=n,v=o,y=l,n=new Nn([r].concat((0,u.Z)(v.map((function(t){return t[3]})))),Object.assign.apply(Object,[{}].concat((0,u.Z)(y.map((function(t){return(0,i.Z)({},t.name,t)}))))))}else Qt=n,n=c}else Qt=n,n=c;else Qt=n,n=c;return n}function kn(){var n,e,r,o,a,s;if(n=Qt,e=function(){var n,e,r,i;n=Qt,(e=En())===c&&(e=null);100===t.charCodeAt(Qt)?(r=y,Qt++):(r=c,0===sn&&yn(L));r!==c&&(i=En())!==c?(Yt=n,n=new en(i,e||1)):(Qt=n,n=c);return n}(),e===c&&(e=function(){var n,e,r;n=Qt,(e=En())===c&&(e=null);t.substr(Qt,2)===p?(r=p,Qt+=2):(r=c,0===sn&&yn(Q));r!==c?(Yt=n,n=new on(e||1)):(Qt=n,n=c);return n}(),e===c&&(e=function(){var n,e,r,i,o,u;n=Qt,(e=En())===c&&(e=null);t.substr(Qt,2)===m?(r=m,Qt+=2):(r=c,0===sn&&yn(Y));r!==c?(i=Qt,46===t.charCodeAt(Qt)?(o=".",Qt++):(o=c,0===sn&&yn($)),o!==c?(_.test(t.charAt(Qt))?(u=t.charAt(Qt),Qt++):(u=c,0===sn&&yn(tt)),u!==c?i=o=[o,u]:(Qt=i,i=c)):(Qt=i,i=c),i===c&&(i=null),Yt=n,a=e,n=new rn((s=i)?parseInt(s[1],10):2,a||1)):(Qt=n,n=c);var a,s;return n}())),e!==c){for(r=[],o=xn();o!==c;)r.push(o),o=xn();Yt=n,s=r,(a=e).modifiers=Object.assign.apply(Object,[{}].concat((0,u.Z)(s.map((function(t){return(0,i.Z)({},t.name,t)}))))),n=a}else Qt=n,n=c;return n}function xn(){var n;return(n=function(){var n,e,r,i,o;n=Qt,33===t.charCodeAt(Qt)?(e=d,Qt++):(e=c,0===sn&&yn(nt));e!==c?(33===t.charCodeAt(Qt)?(r=d,Qt++):(r=c,0===sn&&yn(nt)),r===c&&(r=null),112===t.charCodeAt(Qt)?(i="p",Qt++):(i=c,0===sn&&yn(et)),i===c&&(i=null),(o=Sn())===c&&(o=null),Yt=n,n=new Vt(o,!!r,!!i)):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r;n=Qt,(e=Sn())!==c?(r=function(){var n,e,r;n=Qt,102===t.charCodeAt(Qt)?(e="f",Qt++):(e=c,0===sn&&yn(vt));e!==c&&(r=Sn())!==c?(Yt=n,n=r):(Qt=n,n=c);return n}(),r===c&&(r=null),Yt=n,n=new An(e,r)):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r,i;n=Qt,100===t.charCodeAt(Qt)?(e=y,Qt++):(e=c,0===sn&&yn(L));e!==c?(D.test(t.charAt(Qt))?(r=t.charAt(Qt),Qt++):(r=c,0===sn&&yn(rt)),r===c&&(r=null),(i=Fn())!==c?(Yt=n,n=new dn(r||"l",i)):(Qt=n,n=c)):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r,i;n=Qt,107===t.charCodeAt(Qt)?(e="k",Qt++):(e=c,0===sn&&yn(it));e!==c?(D.test(t.charAt(Qt))?(r=t.charAt(Qt),Qt++):(r=c,0===sn&&yn(rt)),r===c&&(r=null),(i=Fn())!==c?(Yt=n,n=new mn(r||"h",i)):(Qt=n,n=c)):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r,i;n=Qt,114===t.charCodeAt(Qt)?(e="r",Qt++):(e=c,0===sn&&yn(at));e!==c?(111===t.charCodeAt(Qt)?(r="o",Qt++):(r=c,0===sn&&yn(st)),r===c&&(r=null),(i=Sn())===c&&(i=null),Yt=n,n=new Lt(!!r,i)):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r;n=Qt,t.substr(Qt,2)===k?(e=k,Qt+=2):(e=c,0===sn&&yn(ct));e!==c&&(r=Sn())!==c?(Yt=n,n=new an(r)):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r;n=Qt,t.substr(Qt,2)===b?(e=b,Qt+=2):(e=c,0===sn&&yn(lt));e!==c&&(r=Sn())!==c?(Yt=n,n=new un(r)):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r;n=Qt,115===t.charCodeAt(Qt)?(e="s",Qt++):(e=c,0===sn&&yn(ft));e!==c?(97===t.charCodeAt(Qt)?(r="a",Qt++):(r=c,0===sn&&yn(ht)),r===c&&(100===t.charCodeAt(Qt)?(r=y,Qt++):(r=c,0===sn&&yn(L))),r===c&&(r=null),Yt=n,n=new Zn(r||"a")):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r;n=Qt,t.substr(Qt,3)===g?(e=g,Qt+=3):(e=c,0===sn&&yn(ot));e!==c&&(r=On())!==c?(Yt=n,n=new wn(r)):(Qt=n,n=c);return n}())===c&&(n=function(){var n,e,r;n=Qt,t.substr(Qt,3)===w?(e=w,Qt+=3):(e=c,0===sn&&yn(ut));e!==c&&(r=On())!==c?(Yt=n,n=new bn(r)):(Qt=n,n=c);return n}()),n}function Sn(){var n,e,r;return n=Qt,e=function(){var n;t.substr(Qt,2)===Z?(n=Z,Qt+=2):(n=c,0===sn&&yn(yt));n===c&&(t.substr(Qt,2)===S?(n=S,Qt+=2):(n=c,0===sn&&yn(pt)),n===c&&(t.substr(Qt,2)===A?(n=A,Qt+=2):(n=c,0===sn&&yn(mt)),n===c&&(61===t.charCodeAt(Qt)?(n="=",Qt++):(n=c,0===sn&&yn(dt)),n===c&&(t.substr(Qt,2)===E?(n=E,Qt+=2):(n=c,0===sn&&yn(gt)),n===c&&(62===t.charCodeAt(Qt)?(n=">",Qt++):(n=c,0===sn&&yn(wt)),n===c&&(60===t.charCodeAt(Qt)?(n="<",Qt++):(n=c,0===sn&&yn(kt))))))));return n}(),e!==c&&(r=On())!==c?(Yt=n,n=new Ft(e,r)):(Qt=n,n=c),n}function En(){var n,e,r,i,o,u,a,s,l,f;if((n=Fn())===c)if(n=Qt,40===t.charCodeAt(Qt)?(e=T,Qt++):(e=c,0===sn&&yn(bt)),e!==c){if(In(),r=Qt,(i=On())!==c){if(o=[],u=Qt,a=In(),(s=Pn())!==c?(l=In(),(f=On())!==c?u=a=[a,s,l,f]:(Qt=u,u=c)):(Qt=u,u=c),u!==c)for(;u!==c;)o.push(u),u=Qt,a=In(),(s=Pn())!==c?(l=In(),(f=On())!==c?u=a=[a,s,l,f]:(Qt=u,u=c)):(Qt=u,u=c);else o=c;o!==c?r=i=[i,o]:(Qt=r,r=c)}else Qt=r,r=c;r!==c?(i=In(),41===t.charCodeAt(Qt)?(o=C,Qt++):(o=c,0===sn&&yn(xt)),o!==c?(Yt=n,n=x(cn())):(Qt=n,n=c)):(Qt=n,n=c)}else Qt=n,n=c;return n}function Tn(){var t,n,e,i,o,a,s,l,f,h;if(t=Qt,(n=Cn())!==c){for(e=[],i=Qt,o=In(),(a=Pn())!==c?(s=In(),(l=Cn())!==c?i=o=[o,a,s,l]:(Qt=i,i=c)):(Qt=i,i=c);i!==c;)e.push(i),i=Qt,o=In(),(a=Pn())!==c?(s=In(),(l=Cn())!==c?i=o=[o,a,s,l]:(Qt=i,i=c)):(Qt=i,i=c);Yt=t,f=n,h=e,f=Array.isArray(f)?f:[f],t=[].concat((0,u.Z)(f),(0,u.Z)(h.map((function(t){var n=(0,r.Z)(t,4);return[n[1],n[3]]})).flat(2)))}else Qt=t,t=c;return t}function Cn(){var n,e,r,i,o,a;return n=function(){var n,e,r,i,o,a,s;n=Qt,t.substr(Qt,3)===O?(e=O,Qt+=3):(e=c,0===sn&&yn(Zt));e===c&&(t.substr(Qt,4)===N?(e=N,Qt+=4):(e=c,0===sn&&yn(St)),e===c&&(t.substr(Qt,3)===R?(e=R,Qt+=3):(e=c,0===sn&&yn(At)),e===c&&(t.substr(Qt,3)===F?(e=F,Qt+=3):(e=c,0===sn&&yn(Et)),e===c&&(t.substr(Qt,5)===M?(e=M,Qt+=5):(e=c,0===sn&&yn(Tt)),e===c&&(t.substr(Qt,3)===P?(e=P,Qt+=3):(e=c,0===sn&&yn(Ct)),e===c&&(t.substr(Qt,5)===I?(e=I,Qt+=5):(e=c,0===sn&&yn(Ot)),e===c&&(t.substr(Qt,4)===J?(e=J,Qt+=4):(e=c,0===sn&&yn(Nt)),e===c&&(t.substr(Qt,3)===j?(e=j,Qt+=3):(e=c,0===sn&&yn(Rt)),e===c&&(t.substr(Qt,4)===V?(e=V,Qt+=4):(e=c,0===sn&&yn(Mt)),e===c&&(t.substr(Qt,3)===q?(e=q,Qt+=3):(e=c,0===sn&&yn(Pt))))))))))));e!==c?(40===t.charCodeAt(Qt)?(r=T,Qt++):(r=c,0===sn&&yn(bt)),r!==c?(In(),(i=Tn())!==c?(In(),41===t.charCodeAt(Qt)?(o=C,Qt++):(o=c,0===sn&&yn(xt)),o!==c?(Yt=n,l=i,n=["".concat(e,"(")].concat((0,u.Z)(l),[")"])):(Qt=n,n=c)):(Qt=n,n=c)):(Qt=n,n=c)):(Qt=n,n=c);var l;n===c&&(n=Qt,t.substr(Qt,3)===B?(e=B,Qt+=3):(e=c,0===sn&&yn(It)),e===c&&(t.substr(Qt,3)===g?(e=g,Qt+=3):(e=c,0===sn&&yn(ot)),e===c&&(t.substr(Qt,3)===w?(e=w,Qt+=3):(e=c,0===sn&&yn(ut)))),e!==c?(40===t.charCodeAt(Qt)?(r=T,Qt++):(r=c,0===sn&&yn(bt)),r!==c?(In(),(i=Tn())!==c?(In(),44===t.charCodeAt(Qt)?(o=v,Qt++):(o=c,0===sn&&yn(H)),o!==c?(In(),(a=Tn())!==c?(In(),41===t.charCodeAt(Qt)?(s=C,Qt++):(s=c,0===sn&&yn(xt)),s!==c?(Yt=n,n=function(t,n,e){return["".concat(t,"(")].concat((0,u.Z)(n),[","],(0,u.Z)(e),[")"])}(e,i,a)):(Qt=n,n=c)):(Qt=n,n=c)):(Qt=n,n=c)):(Qt=n,n=c)):(Qt=n,n=c)):(Qt=n,n=c));return n}(),n===c&&(n=kn())===c&&(n=On())===c&&(n=Qt,40===t.charCodeAt(Qt)?(e=T,Qt++):(e=c,0===sn&&yn(bt)),e!==c?(In(),(r=Tn())!==c?(In(),41===t.charCodeAt(Qt)?(i=C,Qt++):(i=c,0===sn&&yn(xt)),i!==c?(Yt=n,o=r,a=i,n=[e].concat((0,u.Z)(o),[a])):(Qt=n,n=c)):(Qt=n,n=c)):(Qt=n,n=c),n===c&&(n=gn())),n}function On(){var n,e,r,i;return n=Qt,45===t.charCodeAt(Qt)?Qt++:0===sn&&yn(Jt),Mn()!==c?(e=Qt,G.test(t.charAt(Qt))?(r=t.charAt(Qt),Qt++):(r=c,0===sn&&yn(jt)),r!==c&&(i=Mn())!==c?e=r=[r,i]:(Qt=e,e=c),e===c&&(e=null),Yt=n,n=parseFloat(cn())):(Qt=n,n=c),n}function Fn(){var n,e,r,i;if(n=Qt,z.test(t.charAt(Qt))?(e=t.charAt(Qt),Qt++):(e=c,0===sn&&yn(qt)),e!==c){for(r=[],W.test(t.charAt(Qt))?(i=t.charAt(Qt),Qt++):(i=c,0===sn&&yn(Bt));i!==c;)r.push(i),W.test(t.charAt(Qt))?(i=t.charAt(Qt),Qt++):(i=c,0===sn&&yn(Bt));Yt=n,n=Kt()}else Qt=n,n=c;return n}function Mn(){var n,e,r;if(n=Qt,e=[],W.test(t.charAt(Qt))?(r=t.charAt(Qt),Qt++):(r=c,0===sn&&yn(Bt)),r!==c)for(;r!==c;)e.push(r),W.test(t.charAt(Qt))?(r=t.charAt(Qt),Qt++):(r=c,0===sn&&yn(Bt));else e=c;return e!==c&&(Yt=n,e=Kt()),n=e}function Pn(){var n,e;return n=Qt,"**"===t.substr(Qt,2)?(e="**",Qt+=2):(e=c,0===sn&&yn(_t)),e!==c&&(Yt=n,e="^"),(n=e)===c&&(42===t.charCodeAt(Qt)?(n="*",Qt++):(n=c,0===sn&&yn(Dt)),n===c&&(94===t.charCodeAt(Qt)?(n="^",Qt++):(n=c,0===sn&&yn(Gt)),n===c&&(37===t.charCodeAt(Qt)?(n="%",Qt++):(n=c,0===sn&&yn(zt)),n===c&&(47===t.charCodeAt(Qt)?(n="/",Qt++):(n=c,0===sn&&yn(Wt)),n===c&&(43===t.charCodeAt(Qt)?(n="+",Qt++):(n=c,0===sn&&yn(Ut)),n===c&&(45===t.charCodeAt(Qt)?(n="-",Qt++):(n=c,0===sn&&yn(Jt)))))))),n}function In(){var n,e;for(sn++,n=[],U.test(t.charAt(Qt))?(e=t.charAt(Qt),Qt++):(e=c,0===sn&&yn(Ht));e!==c;)n.push(e),U.test(t.charAt(Qt))?(e=t.charAt(Qt),Qt++):(e=c,0===sn&&yn(Ht));return sn--,e=c,0===sn&&yn(Xt),n}if((e=h())!==c&&Qt===t.length)return e;throw e!==c&&Qt<t.length&&yn({type:"end"}),o=nn,a=tn<t.length?t.charAt(tn):null,s=tn<t.length?vn(tn,tn+1):vn(tn,tn),new Rn(Rn.buildMessage(o,a),o,a,s)}!function(t,n){function e(){this.constructor=t}e.prototype=n.prototype,t.prototype=new e}(Rn,Error),Rn.prototype.format=function(t){var n="Error: "+this.message;if(this.location){var e,r=null;for(e=0;e<t.length;e++)if(t[e].source===this.location.source){r=t[e].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,o=this.location.source+":"+i.line+":"+i.column;if(r){var u=this.location.end,a=Fn("",i.line.toString().length),s=r[i.line-1],c=i.line===u.line?u.column:s.length+1;n+="\n --\x3e "+o+"\n"+a+" |\n"+i.line+" | "+s+"\n"+a+" | "+Fn("",i.column-1)+Fn("",c-i.column,"^")}else n+="\n at "+o}return n},Rn.buildMessage=function(t,n){var e={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var n=t.parts.map((function(t){return Array.isArray(t)?o(t[0])+"-"+o(t[1]):o(t)}));return"["+(t.inverted?"^":"")+n+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function u(t){return e[t.type](t)}return"Expected "+function(t){var n,e,r=t.map(u);if(r.sort(),r.length>0){for(n=1,e=1;n<r.length;n++)r[n-1]!==r[n]&&(r[e]=r[n],e++);r.length=e}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(n)+" found."};var Pn=function(){function t(){(0,c.Z)(this,t)}return(0,s.Z)(t,null,[{key:"parse",value:function(t){if(!t)throw new b("notation");if("string"!=typeof t)throw new TypeError("Notation must be a string");return Mn(t)}}]),t}(),In=Object.freeze({BASE_64:1,JSON:0,OBJECT:2}),Jn=Symbol("notation"),jn=Symbol("maxTotal"),Vn=Symbol("minTotal"),qn=Symbol("expressions"),Bn=Symbol("roll-method"),_n=Symbol("rolls"),Dn=Symbol("set-rolls"),Gn=Symbol("total"),zn=function(t){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return parseFloat(parseFloat("".concat(t)).toFixed(n||0))}(t.calculationValue,2)},Wn=function(){function t(n){if((0,c.Z)(this,t),!n)throw new b("notation");if(this[qn]=[],n instanceof Object&&!Array.isArray(n)){if(!n.notation)throw new b("notation");if("string"!=typeof n.notation)throw new k(n.notation);n.rolls&&this[Dn](n.rolls),this[Jn]=n.notation,this[qn]=Pn.parse(this.notation),this.hasRolls()||this.roll()}else{if("string"!=typeof n)throw new k(n);this[Jn]=n,this[qn]=Pn.parse(this.notation),this.roll()}}return(0,s.Z)(t,[{key:"averageTotal",get:function(){return(this.maxTotal+this.minTotal)/2}},{key:"maxTotal",get:function(){if(!this.hasExpressions())return 0;if(!this[jn]){var t=this[Bn](Tt.max);this[jn]=zn(t)}return this[jn]}},{key:"minTotal",get:function(){if(!this.hasExpressions())return 0;if(!this[Vn]){var t=this[Bn](Tt.min);this[Vn]=zn(t)}return this[Vn]}},{key:"notation",get:function(){return this[Jn]}},{key:"output",get:function(){var t="".concat(this.notation,": ");return this.hasRolls()?t+="".concat(this[_n]," = ").concat(this.total):t+="No dice rolled",t}},{key:"rolls",get:function(){return this[_n]?this[_n].results:[]}},{key:"total",get:function(){return!this[Gn]&&this.hasRolls()&&(this[Gn]=zn(this[_n])),this[Gn]||0}},{key:"export",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:In.JSON;switch(t){case In.BASE_64:return btoa(this.export(In.JSON));case In.JSON:return JSON.stringify(this);case In.OBJECT:return JSON.parse(this.export(In.JSON));default:throw new TypeError('Invalid export format "'.concat(t,'"'))}}},{key:"hasExpressions",value:function(){return this[qn]&&this[qn].length>0}},{key:"hasRolls",value:function(){return this.hasExpressions()&&this.rolls.length>0}},{key:"roll",value:function(){return this[Gn]=0,this[_n]=this[Bn](),this.rolls}},{key:"toJSON",value:function(){return{averageTotal:this.averageTotal,maxTotal:this.maxTotal,minTotal:this.minTotal,notation:this.notation,output:this.output,rolls:this.rolls,total:this.total,type:"dice-roll"}}},{key:"toString",value:function(){return this.output}},{key:Bn,value:function(t){var n;t&&(n=Ot.engine,Ot.engine=t);var e=new vn(this[qn].map((function(t){return t instanceof en||t instanceof Nn?t.roll():t})).filter((function(t){return!!t||0===t})));return t&&(Ot.engine=n),e}},{key:Dn,value:function(t){if(t instanceof vn)this[_n]=t;else if(t instanceof Ht)this[_n]=new vn([t]);else{if(!Array.isArray(t))throw new TypeError("Rolls must be a valid result object, or an array");this[_n]=new vn(t.map((function(t){if(t instanceof vn||t instanceof Ht)return t;if(Array.isArray(t))return new Ht(t);if("object"==typeof t){if(Array.isArray(t.results))return new vn(t.results,t.modifiers||[],t.isRollGroup||!1,"boolean"!=typeof t.useInTotal||t.useInTotal);if(Array.isArray(t.rolls))return new Ht(t.rolls)}return t})))}}}],[{key:"import",value:function(n){if(n){if(Tn(n))return t.import(JSON.parse(n));if(En(n))return t.import(atob(n));if("object"==typeof n)return new t(n);throw new g(n)}throw new b("data")}}]),t}();Symbol("log")}}]);
//# sourceMappingURL=2503a1ce-f52c61559c4f44ea502e.js.map